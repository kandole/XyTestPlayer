<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8"/>
	<title>XyTestPlayer</title>
	<meta name="description" content="" />
	
	<script src="js/swfobject.js"></script>
	<script>
	
		function loadSWF() {
			
			if (player) {
				console.log('removeSWF');
				swfobject.removeSWF(player.id);

				var swfContainer = document.createElement('div');
				swfContainer.id = 'altContent';
				document.getElementsByTagName('body')[0].appendChild(swfContainer);
			}

			console.log('loadSWF');

			var flashvars = {
			};
			var params = {
				menu: "false",
				scale: "noScale",
				allowFullscreen: "true",
				allowScriptAccess: "always",
				bgcolor: "",
				wmode: "direct" // can cause issues with FP settings & webcam
			};
			var attributes = {
				id:"XyTestPlayer"
			};
			swfobject.embedSWF(
				"XyTestPlayer.swf", 
				"altContent", "100%", "100%", "10.0.0", 
				"expressInstall.swf", 
				flashvars, params, attributes, loadFinished);
		}
		loadSWF();

		function loadFinished(obj) {
			console.info(obj);
		}
		
		var isInit = false;
		var player;
		var sdkSelect;
		function onPlayerLoaded() {
			player = document.getElementById('XyTestPlayer');
			
			if (!isInit) {
				isInit = true;
				var sdkList = JSON.parse(player.getSDKList());
				var sdkOptions = '';
				sdkList.forEach(function(item, index) {
					sdkOptions += '<option value="' + item.data + '" data-index="' + index + '" data-url="' + item.url + '">' + item.label + '</option>';
				});
				sdkSelect = document.getElementById('sdk');
				sdkSelect.innerHTML = sdkOptions;
				sdkSelect.addEventListener('change', function() {
					console.log('change');
					loadSWF();
				});
			}
			
			var selectedOption = sdkSelect.selectedOptions[0];
			player.setSDK(selectedOption.dataset.index);
			player.setUrl(selectedOption.dataset.url);
		}	
	
		function onPlayerLoaded1() {
			player = document.getElementById('XyTestPlayer');
			if (player) {

				// setInterval(function() {
				// 	console.log('status: ' + player.getStatus());
				// }, 50);
				console.log('status: ' + player.getStatus());
				player.setUrl('http://demo.vod.u.00cdn.com/FLV/big_buck_bunny_2500kbps_720p.flv');
				player.setBufferTime(1.5);
				player.setPlayDuration(10);
				console.log('isPlaying: ' + player.isPlaying());
				player.play();
				console.log('isPlaying: ' + player.isPlaying());
				setTimeout(function () {
					console.log('metadata: ' + player.getMetaData());
				}, 200)
				
				console.log('status: ' + player.getStatus());
				setTimeout(function() {
					player.stop();
					console.log('isPlaying: ' + player.isPlaying());
					alert(player.printLog());
				}, 5000);
			}
		}

		function onMetaData(metadata) {
			console.info(metadata);
		}

		function onError(err) {
			console.error(err);
		}

	</script>
	<style>
		html, body { height:100%; overflow:hidden; }
		body { margin:0; }

		.control-bar { margin: 10px 20px 0 }
	</style>
</head>
<body>
	<div class="control-bar">
		<label for="sdk">SDK: </label>
		<select id="sdk">
		</select>
		<button onclick="player.play()">play</button>
		<button onclick="player.stop()">stop</button>
	</div>
	<div id="altContent">
		<h1>XyTestPlayer</h1>
		<p><a href="http://www.adobe.com/go/getflashplayer">Get Adobe Flash player</a></p>
	</div>
</body>
</html>